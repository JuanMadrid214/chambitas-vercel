 <!-- modificacion-perfil.html -->
<div class="container py-4">
  <!-- Mensaje flotante -->
  <div *ngIf="mensaje" class="alert alert-info text-center">
    {{ mensaje }}
  </div>

  <!-- Encabezado -->
  <header class="d-flex justify-content-between align-items-center mb-4">
    <a (click)="Regreso()" class="btn btn-outline-primary d-inline-flex align-items-center gap-2">
      <i class="bi bi-arrow-left"></i> Regresar
    </a>
    <h1 class="h3 fw-bold text-dark">Configuración</h1>
    <div class="d-flex align-items-center gap-3">
      <span class="material-icons text-secondary cursor-pointer">notifications</span>
      <div class="d-flex align-items-center gap-2 cursor-pointer">
        <div class="rounded-circle bg-secondary d-flex justify-content-center align-items-center" style="width: 40px; height: 40px;">
          <span class="material-icons text-white">person</span>
        </div>
        <span class="fw-semibold text-dark">{{ usuario.nombre_completo || 'Usuario' }}</span>
        <span class="material-icons text-secondary">arrow_drop_down</span>
      </div>
    </div>
  </header>

  <!-- Tarjeta de configuración -->
  <div class="card border">
    <div class="card-header bg-white border-bottom-0 pb-0">
      <ul class="nav nav-tabs border-bottom">
        <li class="nav-item">
          <a class="nav-link" [class.active]="activeTab === 'perfil'" (click)="activeTab = 'perfil'">
            <span class="material-icons me-1">person_outline</span>
            Datos personales
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" [class.active]="activeTab === 'password'" (click)="activeTab = 'password'">
            <span class="material-icons me-1">lock_open</span>
            Cambio de contraseña
          </a>
        </li>
      </ul>
    </div>

    <div class="card-body">
      <!-- Formulario Datos Personales -->
      <form [class.d-none]="activeTab !== 'perfil'" (ngSubmit)="guardarCambios()">
        <div class="row g-3">
          <div class="col-md-6">
            <label for="fullName" class="form-label">Nombre Completo</label>
            <input id="fullName" type="text" class="form-control" [(ngModel)]="usuario.nombre_completo" name="nombre_completo" required />
          </div>
          <div class="col-md-6">
            <label for="email" class="form-label">Correo electrónico</label>
            <input id="email" type="email" class="form-control" [(ngModel)]="usuario.email" name="email" required />
          </div>
          <div class="col-md-6">
            <label for="telefono" class="form-label">Número de teléfono</label>
            <input id="telefono" type="tel" class="form-control" [(ngModel)]="usuario.telefono" name="telefono" />
          </div>
          <div class="col-md-6">
            <label for="usuario" class="form-label">Usuario</label>
            <input id="usuario" type="text" class="form-control" [(ngModel)]="usuario.usuario" name="usuario" required />
          </div>
          <div class="col-md-6">
            <label for="curp" class="form-label">CURP</label>
            <input id="curp" type="text" class="form-control" [(ngModel)]="usuario.curp" name="curp" />
          </div>
          <div class="col-md-6" *ngIf="usuario.tipo_usuario === 'trabajador'">
            <label for="rfc" class="form-label">RFC</label>
            <input id="rfc" type="text" class="form-control" [(ngModel)]="usuario.rfc" name="rfc" />
          </div>
          <div class="col-md-6" *ngIf="usuario.tipo_usuario === 'trabajador'">
            <label for="especialidad" class="form-label">Especialidad</label>
            <input id="especialidad" type="text" class="form-control" [(ngModel)]="usuario.especialidad" name="especialidad" />
          </div>
          <div class="col-md-6">
            <label for="codigo_postal" class="form-label">Código postal</label>
            <input id="codigo_postal" type="text" class="form-control" [(ngModel)]="usuario.codigo_postal" name="codigo_postal" />
          </div>
          <div class="col-md-6">
            <label for="zona" class="form-label">Zona</label>
            <select id="zona" class="form-select" [(ngModel)]="usuario.zona" name="zona">
              <option value="El Dorado">El Dorado</option>
              <option value="Otra Zona">Otra Zona</option>
            </select>
          </div>
          <div class="col-md-6">
            <label for="ine_url" class="form-label">URL INE</label>
            <input id="ine_url" type="text" class="form-control" [(ngModel)]="usuario.ine_url" name="ine_url" readonly />
          </div>
        </div>

        <div class="mt-4 d-flex justify-content-center">
          <button type="submit" class="btn registration-button">Guardar cambios</button>
        </div>
      </form>

      <!-- Formulario Cambio de Contraseña -->
      <form [class.d-none]="activeTab !== 'password'" (ngSubmit)="cambiarContrasena()" style="max-width: 400px; margin: 0 auto;">
        <div class="row g-3">
          <div class="col-12">
            <label for="actual" class="form-label">Contraseña actual</label>
            <input id="actual" type="password" class="form-control" [(ngModel)]="passwordForm.actual" name="actual" required />
          </div>
          <div class="col-12">
            <label for="nueva" class="form-label">Nueva contraseña</label>
            <input id="nueva" type="password" class="form-control" [(ngModel)]="passwordForm.nueva" name="nueva" required />
          </div>
          <div class="col-12">
            <label for="confirmar" class="form-label">Confirmar nueva contraseña</label>
            <input id="confirmar" type="password" class="form-control" [(ngModel)]="passwordForm.confirmar" name="confirmar" required />
          </div>
        </div>

        <div class="mt-4 d-flex justify-content-center">
          <button type="submit" class="btn registration-button">Guardar contraseña</button>
        </div>
      </form>
    </div>
  </div>
</div>
