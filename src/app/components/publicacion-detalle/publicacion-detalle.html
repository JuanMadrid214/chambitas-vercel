<div *ngIf="publicacion; else loading" class="container py-4">
  <a routerLink="/lista-publicaciones" class="d-flex align-items-center text-decoration-none text-secondary mb-4">
    <i class="bi bi-arrow-left-short fs-5 me-2"></i> Regresar a publicaciones
  </a>

  <div class="card detalle-publicacion-card mb-5 shadow-sm rounded">
    <img [src]="publicacion.imagen_url" alt="Imagen de la publicación" class="detalle-imagen img-fluid rounded-top" />
    <div class="card-body px-4 py-3">
      <h2 class="mb-3">{{ publicacion.nombre || 'Usuario Desconocido' }}</h2>

      <div class="info-meta mb-3 d-flex flex-wrap gap-3">
        <span class="badge bg-primary">
          <i class="bi bi-geo-alt-fill me-1"></i> {{ publicacion.zona || 'Zona no disponible' }}
        </span>
        <span class="badge bg-secondary">
          <i class="bi bi-briefcase-fill me-1"></i> {{ publicacion.especialidad || 'Especialidad no disponible' }}
        </span>
      </div>

      <p class="descripcion-text mb-4">{{ publicacion.descripcion }}</p>

      <p class="text-muted fst-italic small">
        <i class="bi bi-clock me-1"></i> {{ publicacion.fecha | date:'medium' }}
      </p>
    </div>
  </div>

  <section class="comentarios-section">
    <h4 class="mb-4 border-bottom pb-2">Comentarios ({{ comentarios.length }})</h4>

    <div *ngFor="let c of comentarios" class="comentario-card mb-3 p-3 rounded shadow-sm">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <strong class="comentario-usuario">{{ c.usuarioNombre }}</strong>
        <small class="text-muted fst-italic">{{ c.fecha | date:'short' }}</small>
      </div>
      <p class="comentario-texto mb-0">{{ c.texto }}</p>
    </div>

    <form (submit)="agregarComentario()" class="mt-4">
      <label for="comentario" class="form-label fw-semibold mb-2">Agregar un comentario</label>
      <textarea id="comentario" [(ngModel)]="comentario" name="comentario" class="form-control" rows="4" placeholder="Escribe tu comentario aquí..." required></textarea>
      <button type="submit" class="btn btn-primary mt-3" [disabled]="!comentario.trim()">
        Enviar
      </button>
    </form>
  </section>
</div>

<ng-template #loading>
  <div class="text-center py-5">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-3 fs-5 text-secondary">Cargando publicación...</p>
  </div>
</ng-template>
